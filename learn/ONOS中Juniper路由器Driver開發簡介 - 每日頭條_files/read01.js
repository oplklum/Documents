(function(){var getPcbtOS={},userAgent=navigator.userAgent;getPcbtOS.msie=userAgent.match(/MSIE\/([\d.]+)/)?true:false;getPcbtOS.webkit=userAgent.match(/WebKit\/([\d.]+)/)?true:false;getPcbtOS.opera=(userAgent.match(/Opera Mobi/)||userAgent.match(/Opera.([\d.]+)/))?true:false;getPcbtOS.android=userAgent.match(/(Android)\s+([\d.]+)/)||userAgent.match(/Silk-Accelerated/)||userAgent.match(/Android/)?true:false;getPcbtOS.ipad=userAgent.match(/(iPad).*OS\s([\d_]+)/)?true:false;getPcbtOS.iphone=!getPcbtOS.ipad&&userAgent.match(/(iPhone\sOS)\s([\d_]+)/)?true:false;getPcbtOS.webos=userAgent.match(/(webOS|hpwOS)[\s\/]([\d.]+)/)?true:false;getPcbtOS.touchpad=getPcbtOS.webos&&userAgent.match(/TouchPad/)?true:false;getPcbtOS.ios=getPcbtOS.ipad||getPcbtOS.iphone;getPcbtOS.blackberry=userAgent.match(/BlackBerry/)||userAgent.match(/PlayBook/)?true:false;getPcbtOS.fennec=userAgent.match(/fennec/i)?true:false;getPcbtOS.desktop=!(getPcbtOS.ios||getPcbtOS.android||getPcbtOS.blackberry||getPcbtOS.opera||getPcbtOS.fennec);var pcbt={data:{aid:'pcbtAd',country:['tw'],city:[],lockCity:['taipei','banqiao'],getCountryApi:'//static.intentarget.com/gemini/city_json.php',device:typeof(hs_ad_device)!='undefined'?hs_ad_device:'all',adType:typeof(hs_ad_type)!='undefined'?hs_ad_type:'',adPartner:typeof(hs_ad_partner)!='undefined'?hs_ad_partner:'',cssUrl:typeof(hs_ad_css)!='undefined'?hs_ad_css:'//static.intentarget.com/ypa/pcbt/pcbt.css',otherCssUrl:typeof(hs_ad_other_css)!='undefined'?hs_ad_other_css:'',apiUrl:'//static.intentarget.com/ypa/hotspot/json/hotkw.php',jqueryUrl:'//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js',jsAdUrl:'//233ssh.intentarget.com/ypa/',adNum:1,adCallback:'',referrer:[],cookieName:'pcbt_show_ad',cookieTime:0,timeOut:0,conutryApiCallback:{},keyword:'',autoShow:true,autoShowCountry:['tw'],autoShowCity:[],autoShowLockCity:['taipei','banqiao'],autoShowTimeOut:3000,autoShowReferrer:['facebook.com','google.com','yahoo.com'],autoShowCookieName:'pcbt_show_ad_auto',autoShowCookieTime:1,autoShowRamdom:25},adConfig:{'tw_syndication_sitebro_koreastardaily_pm':'000000bd9','tw_syndication_sitebro_buzzhand_pm':'000000b7c','tw_syndication_sitebro_how01_pm':'000000685','tw_syndication_sitebro_dachu_pm':'000000bd7','tw_syndication_sitebro_adqoo_pm':'000000bdb'},init:function(){if(this.data.adType===''||this.data.adPartner===''){return false}var showAll=(this.data.device=="all"),showMobile=(this.data.device=="mobile"&&!getPcbtOS.desktop),showPc=(this.data.device=="pc"&&getPcbtOS.desktop);if(!showAll&&!showMobile&&!showPc){return false}var self=this;this.loadjQuery(function(){self.getCountry()});self.clearData()},clearData:function(){hs_ad_type=undefined;hs_ad_partner=undefined;hs_ad_css=undefined;hs_ad_other_css=undefined},loadCss:function(args){var head=document.getElementsByTagName('head')[0],link=document.createElement('link');link.href=args.src;link.rel='stylesheet';link.type='text/css';head.appendChild(link)},loadJs:function(args){var adArgs=args,_url=args.src;var script=document.createElement('script');script.setAttribute('type','text/javascript');script.setAttribute('src',_url);document.body.appendChild(script)},loadjQuery:function(fn){if(!window.jQuery){this.loadJs({src:this.data.jqueryUrl})}this.ckJQReady(this,function(){(typeof fn==='function')&&fn()})},ckJQReady:function(self,fn){if(window.jQuery){(typeof fn==='function')&&fn()}else{window.setTimeout(function(){self.ckJQReady(self,fn)},50)}},jQueryAjax:function(args){window.jQuery.ajax({type:'get',url:args.url,dataType:'jsonp',jsonp:'callback',jsonpCallback:args.jsonpCallback,success:function(json){(typeof args.fn==='function')&&args.fn(json)},error:function(){}})},getRandomInt:function(minNum,maxNum){return Math.floor(Math.random()*(maxNum-minNum+1))+minNum},stopEvent:function(e){e=e||window.event;if(e&&e.stopPropagation||e&&e.preventDefault){e.stopPropagation();e.preventDefault()}else{window.event.cancelBubble=true;window.event.returnValue=false}},bindScroll:function(fn){var oldMethod=window.onscroll,oldScroll=$(window).scrollTop();window.jQuery(window).scroll(function(){(typeof oldMethod=='function')&&oldMethod.call(this);(typeof fn==="function")&&fn.call(this)})},getCountry:function(args){var self=this;this.jQueryAjax({url:self.data.getCountryApi,jsonpCallback:'pcbtCountryApiCallback',fn:function(json){self.data.conutryApiCallback=json;self.getCountryCallback(json)}})},getCountryCallback:function(args){if(typeof(this.data.country)!="undefined"&&this.data.country.length>0&&this.data.country.indexOf(args.country)<0){return false}if(typeof(this.data.city)!="undefined"&&this.data.city.length>0&&this.data.city.indexOf(args.city)<0){return false}if(typeof(this.data.lockCity)!="undefined"&&this.data.lockCity.length>0&&this.data.lockCity.indexOf(args.city)>=0){return false}this.loadCss({src:this.data.cssUrl});if(this.data.otherCssUrl){this.loadCss({src:this.data.otherCssUrl})}this.getKeyword()},getKeyword:function(){var self=this;this.jQueryAjax({url:self.data.apiUrl+'?num='+self.data.adNum,jsonpCallback:'pcbtApiCallback',fn:function(json){self.data.keyword=json.keyword;self.appendHtml();self.bindClick()}})},appendHtml:function(args){var html='<div id="pcbt">'+'<div class="pcbt_kw" data-active="false">'+'<div class="pcbt_kw_wrap" data-active="false">'+'<svg class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M20.016 12l-8.016 8.016-8.016-8.016 1.453-1.406 5.578 5.578v-12.188h1.969v12.188l5.625-5.578z"></path></svg>'+'更多：<span class="keyword">'+this.data.keyword+'</span></div></div>'+'</div>';window.jQuery('body').append(html);var $pcbtKw=window.jQuery('#pcbt>.pcbt_kw'),pcbtKwTimer=null;this.bindScroll(function(){if(!$pcbtKw.data('active')){$pcbtKw.addClass('active')}clearTimeout(pcbtKwTimer);pcbtKwTimer=setTimeout(function(){if(!$pcbtKw.data('active')){$pcbtKw.removeClass('active')}},5000)});$pcbtKw.on('mouseenter',function(){clearTimeout(pcbtKwTimer)}).on('mouseleave',function(){clearTimeout(pcbtKwTimer);pcbtKwTimer=setTimeout(function(){if(!$pcbtKw.data('active')){$pcbtKw.removeClass('active')}},5000)});setTimeout(function(){$pcbtKw.css({'display':'flex','display':'-webkit-box','display':'-ms-box','-webkit-transition':'all .2s ease-in-out','transition':'all .2s ease-in-out'})},this.getRandomInt(250,500));if(this.data.autoShow){this.autoShowAd()}},bindClick:function(args){var self=this;window.jQuery('#pcbt').on('click','.pcbt_kw',function(e){self.stopEvent(e);var $this=window.jQuery(this);$this.data('active',true).removeClass('active');self.getJsAd({kw:self.data.keyword})}).on('click','.btn_open',function(e){self.stopEvent(e);var $this=window.jQuery(this);$this.removeClass('active');$this.next('.pcbt_small').data('active',true).removeClass('active');window.open('//static.intentarget.com/ypa/ckcount.php?z='+encodeURI($this.data('href')))}).on('click','.close',function(e){self.stopEvent(e);var $this=window.jQuery(this),$pcbtObj=$this.parents('.pcbt');$pcbtObj.removeClass('active');$pcbtObj.next('.pcbt_small').data('active',false).addClass('active');window.jQuery(window).scrollTop(window.jQuery(window).scrollTop()+1)})},autoShowAd:function(args){var self=this;if(typeof(this.data.autoShowCountry)!="undefined"&&this.data.autoShowCountry.length>0&&this.data.autoShowCountry.indexOf(this.data.conutryApiCallback.country)<0){return false}if(typeof(this.data.autoShowCity)!="undefined"&&this.data.autoShowCity.length>0&&this.data.autoShowCity.indexOf(this.data.conutryApiCallback.city)<0){return false}if(typeof(this.data.autoShowLockCity)!="undefined"&&this.data.autoShowLockCity.length>0&&this.data.autoShowLockCity.indexOf(this.data.conutryApiCallback.city)>=0){return false}if(typeof(this.data.autoShowReferrer)!="undefined"&&this.data.autoShowReferrer.length>0){var docReferrer=document.referrer,autoShowReferrer=this.data.autoShowReferrer,isMatch=false;if(docReferrer!=''){for(var i in autoShowReferrer){if(docReferrer.indexOf(autoShowReferrer[i])>=0){isMatch=true}}}if(!isMatch){return false}}if(this.data.autoShowRamdom<this.getRandomInt(1,100)){return false}if(!(getCookie(this.data.autoShowCookieName)!='1')){return false}setTimeout(function(){var $pcbtKw=window.jQuery('#pcbt').find('.pcbt_kw');$pcbtKw.data('active',true).removeClass('active');self.getJsAd({kw:self.data.keyword});setCookie(self.data.autoShowCookieName,1,self.data.autoShowCookieTime)},this.data.autoShowTimeOut)},getJsAd:function(args){var self=this,adConfig=self.adConfig[self.data.adPartner],adType=self.data.adType;if(!adConfig||!adType){return false}this.jQueryAjax({url:self.data.jsAdUrl+'?c='+self.adConfig[self.data.adPartner]+'&p=top&ty='+self.data.adType+'&tt='+encodeURI(args.kw),jsonpCallback:'pcbtJsAdApiCallback',fn:function(json){if(json.ads.length>0){self.insertJsAd(json)}}})},insertJsAd:function(args){var adDatas=args.ads,newImg,$html=window.jQuery('<div class="pcbt btn_open" data-active="false"><div class="pcbt_wrap">'+'<div class="header"><h4 class="title">'+'<span>贊助&nbsp;&nbsp;-&nbsp;&nbsp;</span><span class="sub">'+'</span>'+'</h4><a class="close" rel="nofollow">'+'<svg class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M8.578 16.359l4.594-4.594-4.594-4.594 1.406-1.406 6 6-6 6z"></path></svg>'+'稍等再看</a></div><div class="main"><div class="description"><span class="txt"></span>'+'<span class="siteHost"></span>'+'</div></div><div class="bottom">'+'<svg class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M14.016 17.016l1.969-4.031h-3v-6h6v6l-1.969 4.031h-3zM6 17.016l2.016-4.031h-3v-6h6v6l-2.016 4.031h-3z"></path></svg>'+'<div class="intro">覺得資訊不錯，你就該閱讀更多!</div>'+'<div class="btn"><a rel="nofollow">'+'<span class="icons">'+'<svg class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M20.016 12l-8.016 8.016-8.016-8.016 1.453-1.406 5.578 5.578v-12.188h1.969v12.188l5.625-5.578z"></path></svg>'+'</span><span>閱讀更多</span></a></div></div></div></div>'),$htmlSmall=window.jQuery('<div class="pcbt_small btn_open" data-active="true">'+'<div class="pcbt_small_wrap">'+'<div class="left"><div class="header">'+'<div class="sponsor">贊助</div>'+'<div class="title"><span class="sub"></span>'+'<span class="siteHost"></span></div></div>'+'<div class="description"></div></div>'+'<div class="right"><a rel="nofollow"><span class="icons">'+'<svg class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><path d="M20.016 12l-8.016 8.016-8.016-8.016 1.453-1.406 5.578 5.578v-12.188h1.969v12.188l5.625-5.578z"></path></svg>'+'</span><span>閱讀更多</span></a></div></div></div>');for(var i=0;i<this.data.adNum;i++){var adData=adDatas[i];$html.data('href',adData.clickURL);$html.find('.title > .sub').html(adData.title);$html.find('.description > .txt').html(adData.descr);$html.find('.description > .siteHost').text(adData.sitehost);$htmlSmall.data('href',adData.clickURL);$htmlSmall.find('.title > .sub').html(adData.title);$htmlSmall.find('.title > .siteHost').text(adData.sitehost);$htmlSmall.find('.description').html(adData.descr);if(i==0){newImg=new Image(1,1);newImg.src=adData.h_img;newImg.style.position='fixed';newImg.style.bottom='-1px'}}window.jQuery('#pcbt').append($html);window.jQuery('#pcbt').append($htmlSmall);window.jQuery('#pcbt').append(newImg);setTimeout(function(){$html.addClass('active')},250);var pcbtSmallTimer=null;this.bindScroll(function(){if(!$htmlSmall.data('active')){$htmlSmall.addClass('active')}clearTimeout(pcbtSmallTimer);pcbtSmallTimer=setTimeout(function(){if(!$htmlSmall.data('active')){$htmlSmall.removeClass('active')}},5000)});$htmlSmall.on('mouseenter',function(){clearTimeout(pcbtSmallTimer)}).on('mouseleave',function(){clearTimeout(pcbtSmallTimer);pcbtSmallTimer=setTimeout(function(){if(!$htmlSmall.data('active')){$htmlSmall.removeClass('active')}},5000)})}};window.pcbt=pcbt;pcbt.init()})();function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toGMTString();document.cookie=cname+"="+cvalue+"; "+expires}function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i].trim();if(c.indexOf(name)==0)return c.substring(name.length,c.length)}return""}
